import{createContext as re}from"react";var v=re(null);import{createContext as se}from"react";var C=se(null);import{useEffect as S,useState as I}from"react";function O(t){let e=t?.yogaNode?.getComputedLayout();if(e)return{width:e.width,height:e.height}}function y(t){if(!t)return;let{left:e,top:o}=ue(t);return{left:e,top:o}}function ue(t){let e=t,o=1,n=1;for(;e;){if(!e.yogaNode)return{left:o,top:n};let s=e.yogaNode.getComputedLayout();o+=s.left,n+=s.top,e=e.parentNode}return{left:o,top:n}}function b(t){if(!t)return;let e=y(t),o=O(t);if(!e||!o)return;let{left:n,top:s}=e,{width:r,height:i}=o,c=n+r,E=s+i;return{left:n,top:s,right:c,bottom:E,width:r,height:i,x:n,y:s}}function W(t,e=[]){let[o,n]=I({top:0,left:0});return S(function(){let r=y(t.current);r&&n(r)},e),o}function _(t,e=[]){let[o,n]=I({width:0,height:0});return S(function(){let r=O(t.current);r&&n(r)},e),o}function j(t,e=[]){let[o,n]=I({left:0,top:0,right:0,bottom:0,width:0,height:0,x:0,y:0});return S(function(){let r=b(t.current);r&&n(r)},e),o}import{useContext as ie}from"react";import{Mouse as le}from"xterm-mouse";var f={PRESS:"press",RELEASE:"release",CLICK:"click",WHEEL:"wheel",MOVE:"move",DRAG:"drag"},H={autoEnable:!0,cacheInvalidationMs:16},M="[ink-mouse]",g={NO_PROVIDER:"Mouse hooks must be used within a MouseProvider. Wrap your component tree with <MouseProvider>.",NOT_SUPPORTED:"Terminal does not support mouse events",NULL_REF:"ref is null or undefined",NULL_HANDLER:"handler is null or undefined"};function T(){let t=ie(v);if(!t)throw new Error(`${M} ${g.NO_PROVIDER}`);let e=le.isSupported();return{...t,isSupported:e}}import{useContext as ae,useEffect as me,useRef as fe}from"react";function a(t,e,o){let n=ae(C),s=fe(null);s.current===null&&(s.current=`${t}-${Date.now()}-${Math.random()}`),me(()=>{if(!n)throw new Error(`${M} ${g.NO_PROVIDER}`);if(!e){process.env.NODE_ENV!=="production"&&console.warn(`${M} ${g.NULL_REF}`);return}if(!o)return;let r=s.current;if(r)return n.registerHandler(r,e,t,o),()=>{n.unregisterHandler(r)}},[e,o,n,t])}function $(t,e){a("click",t,e)}function A(t,e){a("mouseDrag",t,e)}function U(t,e){a("mouseEnter",t,e)}function X(t,e){a("mouseLeave",t,e)}function G(t,e){a("mouseMove",t,e)}function F(t,e){a("mousePress",t,e)}function K(t,e){a("mouseRelease",t,e)}function q(t,e){a("wheel",t,e)}import{useCallback as w,useEffect as be,useMemo as te,useRef as xe,useState as Ce}from"react";function L(t,e,o){return t>=o.left&&t<=o.right&&e>=o.top&&e<=o.bottom}function vt(t){return{x:t.left+t.width/2,y:t.top+t.height/2}}function bt(t,e){return!(t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)}function z(t,e){return typeof t!="function"?(e&&console.error(`[ink-mouse] Invalid handler for '${e}' event: expected a function, got ${typeof t}`),!1):t.length<0||t.length>10?(e&&console.error(`[ink-mouse] Invalid handler for '${e}' event: function has unusual parameter count (${t.length})`),!1):!0}function J(t,e,o){let n=m=>R=>{let{x,y:l}=R;o.forEach(p=>{if(p.type!==m||!z(p.handler,m))return;let d=t(p.ref);d.bounds&&L(x,l,d.bounds)&&p.handler(R)})},s=m=>{let{x:R,y:x}=m;o.forEach(l=>{if(!["mouseMove","mouseEnter","mouseLeave"].includes(l.type)||!z(l.handler,l.type))return;let p=t(l.ref);if(!p.bounds)return;let d=L(R,x,p.bounds);switch(l.type){case"mouseMove":d&&l.handler(m);break;case"mouseEnter":{let u=e.get(l.ref)??!1;d!==u&&(e.set(l.ref,d),d&&l.handler(m));break}case"mouseLeave":{let u=e.get(l.ref)??!1;d!==u&&(e.set(l.ref,d),d||l.handler(m));break}}})},r=n("click"),i=n("wheel"),c=n("mousePress"),E=n("mouseRelease"),h=n("mouseDrag");return{handleClick:r,handleMove:s,handleWheel:i,handlePress:c,handleRelease:E,handleDrag:h}}import{useStdout as ce}from"ink";import{useCallback as de,useEffect as pe,useReducer as Ee,useRef as Q}from"react";function Y(t=100){let[e]=Ee(i=>i+1,0),{stdout:o}=ce(),n=Q(new WeakMap),s=Q(new WeakMap);return pe(()=>{n.current=new WeakMap},[o.columns,o.rows]),{getCachedState:de(i=>{let c=n.current.get(i),E=Date.now();if(c?.bounds&&c.boundsTimestamp&&c.layoutVersion===e&&E-c.boundsTimestamp<t)return c;let m={bounds:b(i.current),boundsTimestamp:E,layoutVersion:e};return n.current.set(i,m),m},[t,e]),hoverStateRef:s}}import{useStdin as Re,useStdout as Me}from"ink";import{useEffect as ge,useRef as he,useState as ve}from"react";import{Mouse as Z}from"xterm-mouse";function ee(t){let e=he(null),[o,n]=ve(!1),{stdin:s,setRawMode:r}=Re(),{stdout:i}=Me();return ge(()=>Z.isSupported(s,i)?(e.current=new Z({inputStream:s,outputStream:i,setRawMode:r}),t&&e.current.enable(),n(!0),()=>{e.current&&(e.current.destroy?.(),e.current=null),n(!1)}):(console.warn(`${M} ${g.NOT_SUPPORTED}`),()=>{}),[t,s,i,r]),{mouseRef:e,isTracking:o}}import{jsx as ne}from"react/jsx-runtime";var oe=({children:t,autoEnable:e=H.autoEnable,cacheInvalidationMs:o=H.cacheInvalidationMs})=>{let[n,s]=Ce(!1),{mouseRef:r,isTracking:i}=ee(e),{getCachedState:c,hoverStateRef:E}=Y(o),h=xe(new Map),m=w((u,k,P,D)=>{h.current.set(u,{type:P,ref:k,handler:D})},[]),R=w(u=>{h.current.delete(u)},[]),x=te(()=>({registerHandler:m,unregisterHandler:R}),[m,R]);be(()=>{let u=r.current;if(!u)return()=>{};let{handleClick:k,handleMove:P,handleWheel:D,handlePress:V,handleRelease:N,handleDrag:B}=J(c,E.current,h.current);return u.on(f.CLICK,k),u.on(f.MOVE,P),u.on(f.WHEEL,D),u.on(f.PRESS,V),u.on(f.RELEASE,N),u.on(f.DRAG,B),()=>{u.off(f.CLICK,k),u.off(f.MOVE,P),u.off(f.WHEEL,D),u.off(f.PRESS,V),u.off(f.RELEASE,N),u.off(f.DRAG,B)}},[c,E,r]);let l=w(()=>{r.current&&!n&&(r.current.enable(),s(!0))},[n,r]),p=w(()=>{r.current&&n&&(r.current.disable(),s(!1))},[n,r]),d=te(()=>({isEnabled:n,isTracking:i,enable:l,disable:p}),[n,i,l,p]);return ne(v.Provider,{value:d,children:ne(C.Provider,{value:x,children:t})})};function Xt(t,e){return t[e]}function Gt(t){return t.shift||t.alt||t.ctrl}function Ft(t){return t}function Kt(t,e){return!(e.shift!==void 0&&t.shift!==e.shift||e.alt!==void 0&&t.alt!==e.alt||e.ctrl!==void 0&&t.ctrl!==e.ctrl)}export{v as MouseContext,oe as MouseProvider,Kt as filterEvent,b as getBoundingClientRect,O as getElementDimensions,y as getElementPosition,vt as getRectCenter,Gt as hasAnyModifier,Xt as hasModifier,L as isPointInRect,bt as isRectOverlapping,Ft as transformEvent,j as useBoundingClientRect,_ as useElementDimensions,W as useElementPosition,T as useMouse,$ as useOnClick,A as useOnDrag,U as useOnMouseEnter,X as useOnMouseLeave,G as useOnMouseMove,F as useOnPress,K as useOnRelease,q as useOnWheel};
//# sourceMappingURL=index.js.map