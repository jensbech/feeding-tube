"use strict";var B=Object.defineProperty;var fe=Object.getOwnPropertyDescriptor;var ce=Object.getOwnPropertyNames;var de=Object.prototype.hasOwnProperty;var pe=(t,e)=>{for(var o in e)B(t,o,{get:e[o],enumerable:!0})},Ee=(t,e,o,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of ce(e))!de.call(t,r)&&r!==o&&B(t,r,{get:()=>e[r],enumerable:!(n=fe(e,r))||n.enumerable});return t};var Re=t=>Ee(B({},"__esModule",{value:!0}),t);var Oe={};pe(Oe,{MouseContext:()=>v,MouseProvider:()=>Y,filterEvent:()=>Ce,getBoundingClientRect:()=>b,getElementDimensions:()=>y,getElementPosition:()=>k,getRectCenter:()=>ge,hasAnyModifier:()=>be,hasModifier:()=>ve,isPointInRect:()=>V,isRectOverlapping:()=>he,transformEvent:()=>xe,useBoundingClientRect:()=>j,useElementDimensions:()=>_,useElementPosition:()=>W,useMouse:()=>$,useOnClick:()=>A,useOnDrag:()=>U,useOnMouseEnter:()=>X,useOnMouseLeave:()=>G,useOnMouseMove:()=>F,useOnPress:()=>K,useOnRelease:()=>q,useOnWheel:()=>z});module.exports=Re(Oe);var ne=require("react"),v=(0,ne.createContext)(null);var oe=require("react"),S=(0,oe.createContext)(null);var g=require("react");function y(t){let e=t?.yogaNode?.getComputedLayout();if(e)return{width:e.width,height:e.height}}function k(t){if(!t)return;let{left:e,top:o}=Me(t);return{left:e,top:o}}function Me(t){let e=t,o=1,n=1;for(;e;){if(!e.yogaNode)return{left:o,top:n};let r=e.yogaNode.getComputedLayout();o+=r.left,n+=r.top,e=e.parentNode}return{left:o,top:n}}function b(t){if(!t)return;let e=k(t),o=y(t);if(!e||!o)return;let{left:n,top:r}=e,{width:s,height:i}=o,d=n+s,R=r+i;return{left:n,top:r,right:d,bottom:R,width:s,height:i,x:n,y:r}}function W(t,e=[]){let[o,n]=(0,g.useState)({top:0,left:0});return(0,g.useEffect)(function(){let s=k(t.current);s&&n(s)},e),o}function _(t,e=[]){let[o,n]=(0,g.useState)({width:0,height:0});return(0,g.useEffect)(function(){let s=y(t.current);s&&n(s)},e),o}function j(t,e=[]){let[o,n]=(0,g.useState)({left:0,top:0,right:0,bottom:0,width:0,height:0,x:0,y:0});return(0,g.useEffect)(function(){let s=b(t.current);s&&n(s)},e),o}var re=require("react"),se=require("xterm-mouse");var c={PRESS:"press",RELEASE:"release",CLICK:"click",WHEEL:"wheel",MOVE:"move",DRAG:"drag"},T={autoEnable:!0,cacheInvalidationMs:16},x="[ink-mouse]",C={NO_PROVIDER:"Mouse hooks must be used within a MouseProvider. Wrap your component tree with <MouseProvider>.",NOT_SUPPORTED:"Terminal does not support mouse events",NULL_REF:"ref is null or undefined",NULL_HANDLER:"handler is null or undefined"};function $(){let t=(0,re.useContext)(v);if(!t)throw new Error(`${x} ${C.NO_PROVIDER}`);let e=se.Mouse.isSupported();return{...t,isSupported:e}}var P=require("react");function a(t,e,o){let n=(0,P.useContext)(S),r=(0,P.useRef)(null);r.current===null&&(r.current=`${t}-${Date.now()}-${Math.random()}`),(0,P.useEffect)(()=>{if(!n)throw new Error(`${x} ${C.NO_PROVIDER}`);if(!e){process.env.NODE_ENV!=="production"&&console.warn(`${x} ${C.NULL_REF}`);return}if(!o)return;let s=r.current;if(s)return n.registerHandler(s,e,t,o),()=>{n.unregisterHandler(s)}},[e,o,n,t])}function A(t,e){a("click",t,e)}function U(t,e){a("mouseDrag",t,e)}function X(t,e){a("mouseEnter",t,e)}function G(t,e){a("mouseLeave",t,e)}function F(t,e){a("mouseMove",t,e)}function K(t,e){a("mousePress",t,e)}function q(t,e){a("mouseRelease",t,e)}function z(t,e){a("wheel",t,e)}var m=require("react");function V(t,e,o){return t>=o.left&&t<=o.right&&e>=o.top&&e<=o.bottom}function ge(t){return{x:t.left+t.width/2,y:t.top+t.height/2}}function he(t,e){return!(t.right<e.left||t.left>e.right||t.bottom<e.top||t.top>e.bottom)}function ue(t,e){return typeof t!="function"?(e&&console.error(`[ink-mouse] Invalid handler for '${e}' event: expected a function, got ${typeof t}`),!1):t.length<0||t.length>10?(e&&console.error(`[ink-mouse] Invalid handler for '${e}' event: function has unusual parameter count (${t.length})`),!1):!0}function ie(t,e,o){let n=f=>h=>{let{x:w,y:l}=h;o.forEach(E=>{if(E.type!==f||!ue(E.handler,f))return;let p=t(E.ref);p.bounds&&V(w,l,p.bounds)&&E.handler(h)})},r=f=>{let{x:h,y:w}=f;o.forEach(l=>{if(!["mouseMove","mouseEnter","mouseLeave"].includes(l.type)||!ue(l.handler,l.type))return;let E=t(l.ref);if(!E.bounds)return;let p=V(h,w,E.bounds);switch(l.type){case"mouseMove":p&&l.handler(f);break;case"mouseEnter":{let u=e.get(l.ref)??!1;p!==u&&(e.set(l.ref,p),p&&l.handler(f));break}case"mouseLeave":{let u=e.get(l.ref)??!1;p!==u&&(e.set(l.ref,p),p||l.handler(f));break}}})},s=n("click"),i=n("wheel"),d=n("mousePress"),R=n("mouseRelease"),O=n("mouseDrag");return{handleClick:s,handleMove:r,handleWheel:i,handlePress:d,handleRelease:R,handleDrag:O}}var le=require("ink"),M=require("react");function ae(t=100){let[e]=(0,M.useReducer)(i=>i+1,0),{stdout:o}=(0,le.useStdout)(),n=(0,M.useRef)(new WeakMap),r=(0,M.useRef)(new WeakMap);return(0,M.useEffect)(()=>{n.current=new WeakMap},[o.columns,o.rows]),{getCachedState:(0,M.useCallback)(i=>{let d=n.current.get(i),R=Date.now();if(d?.bounds&&d.boundsTimestamp&&d.layoutVersion===e&&R-d.boundsTimestamp<t)return d;let f={bounds:b(i.current),boundsTimestamp:R,layoutVersion:e};return n.current.set(i,f),f},[t,e]),hoverStateRef:r}}var N=require("ink"),D=require("react"),J=require("xterm-mouse");function me(t){let e=(0,D.useRef)(null),[o,n]=(0,D.useState)(!1),{stdin:r,setRawMode:s}=(0,N.useStdin)(),{stdout:i}=(0,N.useStdout)();return(0,D.useEffect)(()=>J.Mouse.isSupported(r,i)?(e.current=new J.Mouse({inputStream:r,outputStream:i,setRawMode:s}),t&&e.current.enable(),n(!0),()=>{e.current&&(e.current.destroy?.(),e.current=null),n(!1)}):(console.warn(`${x} ${C.NOT_SUPPORTED}`),()=>{}),[t,r,i,s]),{mouseRef:e,isTracking:o}}var Q=require("react/jsx-runtime"),Y=({children:t,autoEnable:e=T.autoEnable,cacheInvalidationMs:o=T.cacheInvalidationMs})=>{let[n,r]=(0,m.useState)(!1),{mouseRef:s,isTracking:i}=me(e),{getCachedState:d,hoverStateRef:R}=ae(o),O=(0,m.useRef)(new Map),f=(0,m.useCallback)((u,I,H,L)=>{O.current.set(u,{type:H,ref:I,handler:L})},[]),h=(0,m.useCallback)(u=>{O.current.delete(u)},[]),w=(0,m.useMemo)(()=>({registerHandler:f,unregisterHandler:h}),[f,h]);(0,m.useEffect)(()=>{let u=s.current;if(!u)return()=>{};let{handleClick:I,handleMove:H,handleWheel:L,handlePress:Z,handleRelease:ee,handleDrag:te}=ie(d,R.current,O.current);return u.on(c.CLICK,I),u.on(c.MOVE,H),u.on(c.WHEEL,L),u.on(c.PRESS,Z),u.on(c.RELEASE,ee),u.on(c.DRAG,te),()=>{u.off(c.CLICK,I),u.off(c.MOVE,H),u.off(c.WHEEL,L),u.off(c.PRESS,Z),u.off(c.RELEASE,ee),u.off(c.DRAG,te)}},[d,R,s]);let l=(0,m.useCallback)(()=>{s.current&&!n&&(s.current.enable(),r(!0))},[n,s]),E=(0,m.useCallback)(()=>{s.current&&n&&(s.current.disable(),r(!1))},[n,s]),p=(0,m.useMemo)(()=>({isEnabled:n,isTracking:i,enable:l,disable:E}),[n,i,l,E]);return(0,Q.jsx)(v.Provider,{value:p,children:(0,Q.jsx)(S.Provider,{value:w,children:t})})};function ve(t,e){return t[e]}function be(t){return t.shift||t.alt||t.ctrl}function xe(t){return t}function Ce(t,e){return!(e.shift!==void 0&&t.shift!==e.shift||e.alt!==void 0&&t.alt!==e.alt||e.ctrl!==void 0&&t.ctrl!==e.ctrl)}0&&(module.exports={MouseContext,MouseProvider,filterEvent,getBoundingClientRect,getElementDimensions,getElementPosition,getRectCenter,hasAnyModifier,hasModifier,isPointInRect,isRectOverlapping,transformEvent,useBoundingClientRect,useElementDimensions,useElementPosition,useMouse,useOnClick,useOnDrag,useOnMouseEnter,useOnMouseLeave,useOnMouseMove,useOnPress,useOnRelease,useOnWheel});
//# sourceMappingURL=index.cjs.map